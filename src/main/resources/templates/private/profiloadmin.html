<!DOCTYPE html>
<html lang="it" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pannello Admin</title>
    <link rel="stylesheet" th:href="@{/css/profiloadmin.css}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
</head>

<body>
  <header class="header">
    <h1>
        <img th:src="@{/image/logo2.png}" alt="Logo" height="130">
      Area Amministratore
    </h1>
    <div class="header-nav-links">
      <a th:href="@{/dashboard}" class="nav-switch-button">
        <i class="fas fa-table-columns"></i> Vai alla Dashboard
      </a>
      <a th:href="@{/profilo}" class="nav-switch-button">
        <i class="fas fa-user-circle"></i> Vai allâ€™Area Utente
      </a>
      <form th:action="@{/logout}" method="post" style="display: inline;">
        <button type="submit" class="nav-switch-button logout" style="border:none; background:none; cursor:pointer; padding:0; font-family:inherit; font-size:inherit; color:inherit;">
            <i class="fas fa-sign-out-alt"></i> Logout
        </button>
      </form>
    </div>
  </header>

  <main class="admin-container">
    <section class="section-table">
        <div class="table-wrapper">
        <table class="candidature-table">
          <thead>
            <tr>
              <th>Candidato</th>
              <th>Annuncio</th>
              <th>Stato</th>
              <th>Azioni</th>
            </tr>
          </thead>
          <tbody>
            <tr th:each="candidatura : ${listaCandidature}">
              <td th:text="${candidatura.nomeUtente + ' ' + candidatura.cognomeUtente}">Mario Rossi</td>
              <td th:text="${candidatura.mansioneTirocinio}">Frontend Developer</td>
              <td>
                <span class="status"
                      th:classappend="${candidatura.stato == 'Accettata' ? 'status-accepted' : (candidatura.stato == 'Rifiutata' ? 'status-rejected' : 'status-pending')}"
                      th:text="${candidatura.stato}">
                  In Attesa
                </span>
              </td>
              <td class="action-buttons">
                <button class="btn-action view"><i class="fas fa-eye"></i></button>
                
                <form th:action="@{/admin/candidature/{id}/accetta(id=${candidatura.id_candidatura})}" method="post" style="display:inline;">
                    <button type="submit" class="btn-action accept"><i class="fas fa-check"></i></button>
                </form>
                
                <form th:action="@{/admin/candidature/{id}/rifiuta(id=${candidatura.id_candidatura})}" method="post" style="display:inline;">
                    <button type="submit" class="btn-action reject"><i class="fas fa-times"></i></button>
                </form>
                
                <form th:action="@{/admin/candidature/{id}/elimina(id=${candidatura.id_candidatura})}" method="post" style="display:inline;">
                    <button type="submit" class="btn-action remove"><i class="fas fa-trash"></i></button>
                </form>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>
  </main>

  <div id="modal" class="modal">
    <div class="modal-content">
      <span class="close-btn" id="closeModal">&times;</span>
      <h2><i class="fas fa-plus-square"></i> Aggiungi / Modifica Annuncio</h2>

      <form class="tirocinio-form">
        <div class="form-group">
          <label for="titolo">Titolo Annuncio:</label>
          <input type="text" id="titolo" placeholder="Esempio: Data Scientist Intern" required>
        </div>

        <div class="form-group">
          <label for="azienda">Azienda:</label>
          <select id="azienda" required>
            <option disabled selected>Seleziona un'azienda</option>
            <option>TechCorp</option>
            <option>DesignStudio</option>
            <option>DataSolutions</option>
            <option>Innovatek</option>
            <option>Softwave</option>
          </select>
        </div>

        <div class="form-group">
          <label for="durata">Durata (Mesi):</label>
          <input type="number" id="durata" min="1" max="12" placeholder="1-12" required>
        </div>

        <div class="form-group">
          <label for="orari">Orari di Lavoro:</label>
          <input type="text" id="orari" placeholder="Full-time / Part-time / Flessibile">
        </div>

        <div class="form-group full-width">
          <label>Competenze Richieste:</label>
          <div class="tag-select" id="richieste"></div>
        </div>

        <div class="form-group full-width">
          <label>Competenze Acquisibili:</label>
          <div class="tag-select" id="acquisibili"></div>
        </div>

        <div class="form-group full-width">
          <label for="descrizione">Descrizione:</label>
          <textarea id="descrizione" rows="3" placeholder="Descrizione del tirocinio"></textarea>
        </div>

        <div class="form-actions full-width">
          <button type="submit" class="btn-primary"><i class="fas fa-save"></i> Salva</button>
          <button type="reset" class="btn-secondary"><i class="fas fa-eraser"></i> Svuota</button>
        </div>
      </form>
    </div>
  </div>

  <script>
    const modal = document.getElementById('modal');
    document.getElementById('openModal').onclick = () => modal.style.display = 'flex';
    document.getElementById('closeModal').onclick = () => modal.style.display = 'none';
    window.onclick = e => { if (e.target === modal) modal.style.display = 'none'; };

    const skillLists = {
      richieste: ["Python", "JavaScript", "HTML", "CSS", "Java", "SQL", "Machine Learning", "React", "C++", "UI/UX Design"],
      acquisibili: ["Teamwork", "Project Management", "Problem Solving", "Analisi Dati", "Comunicazione", "Leadership"]
    };

    function createTagSelector(containerId, skills) {
      const container = document.getElementById(containerId);
      skills.forEach(skill => {
        const tag = document.createElement("div");
        tag.classList.add("skill-tag");
        tag.textContent = skill;
        tag.onclick = () => tag.classList.toggle("selected");
        container.appendChild(tag);
      });
    }

    createTagSelector("richieste", skillLists.richieste);
    createTagSelector("acquisibili", skillLists.acquisibili);
  </script>
</body>
</html>